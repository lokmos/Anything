# p1 封面

各位老师好，我是来自 张老师 课题组的周予恺。今天非常感谢各位老师参加我的中期答辩。

本次汇报将围绕我目前正在进行的研究工作展开，主题是基于流方程的量子动力学模拟方法的优化与GPU实现。该工作聚焦于突破当前多体量子系统动力学模拟中的规模瓶颈与算法效率问题，尝试引入扰乱变换与GPU并行计算策略提升传统 CUT 方法的可扩展性。

# p2 研究背景

先简单介绍一下这个工作的背景。

量子动力学研究的是量子多体系统在时间上的演化行为，比如一个系统从初态演化到某个远期态，它的能量是怎么转移的、信息是怎么扩散的等等。

但模拟这样的系统非常困难，原因是希尔伯特空间的维度随着粒子数呈指数增长——这意味着，系统越大，需要模拟的数据量也急剧变大。

有几个常用的方法：

- 精确对角化，也叫 ED（Exact Diagonalization），是最直接的方法，它把哈密顿量完全对角化，能得到精确结果。但由于维度增长得太快，它通常最多只能处理十几个粒子的系统。
    - 所谓哈密顿量，在量子力学中，代表了系统的“总能量”，在数学形式上，就是一个矩阵
- 张量网络方法，，这种方法将原来的 $2^L$ 大小的大矩阵写成一系列小矩阵相乘的方式。这类方法适合处理一维的基态，也可以做一些短时间的动力学模拟。但如果系统中出现大量纠缠，张量网络的压缩效率就会迅速下降，计算开销也会变得很大，这被称为纠缠障碍。

所以目前缺少一种方法，能够在保持一定准确性的同时，还能处理相对大的系统，并支持时间演化分析。而**连续单参变换方法（Flow Equation / CUT）**就是一种有潜力填补这个空白的方法。

# p3

在刚才介绍了哈密顿量之后，我们接下来引出本研究中采用的核心方法：**连续酉变换（Continuous Unitary Transformations）**，也就是所谓的 CUT 方法。

这个方法最初由 Wegner 和 Glazek 等人提出，其基本思想是：

我们不直接对 $H$ 做对角化，而是引入一个“流动参数” $l$，令哈密顿量随着 $l$ 演化：
$$
\frac{dH(l)}{dl} = [\eta(l), H(l)]
$$

这里的 $\eta(l)$ 被称为“生成元”，它控制了每一步变换的方向。



当 $l \to \infty$ 时，$H(l)$ 会逐渐变成对角形式，我们就可以更方便地处理系统的演化问题。

这个变换是酉的，也就是说它不会改变系统的物理性质，只是换了一个更好处理的表示方式。

在这项工作中，我们结合了这个 CUT 框架，去研究复杂量子系统的动力学行为，同时探索如何让整个过程在 GPU 上高效运行。


# p5

这一页介绍的是我们使用的核心方法：**连续酉变换（Continuous Unitary Transformations, CUT）**。

CUT 的目标是通过一系列连续的、微小的酉变换，把原始哈密顿量逐渐“对角化”。

公式上写为：
$$
H(l) = U^\dagger(l)\, H\, U(l)
$$
它满足一个微分方程：
$$
\frac{dH}{dl} = [\eta(l), H(l)]
$$
其中 $l$ 被称为“流时间”，可以理解为一种算法时间，从 $l = 0$ 开始演化，逐步逼近对角形式。

酉变换 $dU(l)$ 可写为：
$$
dU(l) = \exp(-\eta(l)\,dl) \approx 1 - \eta(l)\,dl
$$
$\eta(l)$ 是生成元，决定每一步如何变换。

这里的中括号是量子力学中对易子的概念：$[A, B] = AB - BA$

数值实现策略：
- $H^{(2)}$ 为矩阵形式，复杂度 $\mathcal{O}(L^2)$；
- $H^{(4)}$ 为张量形式，复杂度 $\mathcal{O}(L^4)$；
- 只保留至四阶截断，防止高阶爆炸。

# p6

这一页介绍的是 CUT 方法如何**处理高维系统**的问题。

通常我们处理二维格点系统时，格点只和自己临近的格点发生作用，属于“局域哈密顿量”。

为了让 CUT 方法可以处理这些高维系统，我们采用一种技巧：**将系统一维展开**。具体方法如下：

- 将 $d$ 维晶格用某种顺序编号成 $1$ 到 $L$，将所有格点排成一条线；
- 原本的近邻耦合项在展开后就变成了一维系统中的“长程跃迁”。

也就是说，原来只连接 $(i,j)$ 近邻格点的项，现在会变成连接线性编号上较远的格点。

但这对 CUT 方法不是问题：
- 因为 CUT 的基本操作是计算 operator 的对易子，这完全取决于代数结构（例如泡利代数），
- 它**不依赖系统的几何维度**。

因此，这种一维展开策略使 CUT 可以处理任意维度的系统，包括高维无序体系、拓扑材料等。

# p7

图片展示

# p8&p9

CUT 的核心问题之一是可能遇到 **不稳定固定点**。

CUT 采用的基本方程是：
$$
\frac{dH(l)}{dl} = [\eta(l), H(l)]
$$
常用的 Wegner 生成元为：
$$
\eta(l) = [H_0(l), V(l)]
$$
其中 $H_0$ 是对角部分，$V$ 是非对角部分。

如果系统存在许多近简并能级，即 $H_{ii}^{(2)} \approx H_{jj}^{(2)}$，那么：
$$
\eta_{ij} \propto (H_{ii} - H_{jj}) \cdot V_{ij} \to 0
$$
就会导致对角化速度变慢，甚至停滞，出现所谓“固定点”。

这限制了 CUT 在某些系统中的收敛性和精度。

# p10

为了解决 CUT 方法中“固定点”带来的对角化停滞问题，我们引入了 **扰乱变换（Scrambling Transform）**。

其思想是先通过一个酉变换 $S(l)$ 对系统进行预处理，打破系统中的近简并结构，使后续 CUT 更容易收敛。

扰乱变换本身不改变系统物理性质，其数学形式为：
$$
dS(l) = \exp(-\lambda(l)\, dl)
$$
其中 $\lambda(l)$ 是专门设计的扰动生成元，用于激活能级差很小的部分。

通过这种变换，可以显著提升 CUT 的稳定性与数值效率。

# p11 展示图片

# p12&p13

除了上面的稳定点问题外，传统 CUT 方法中的一个瓶颈是 —— 物理量的计算需要变换回原始基底：

$$
\langle \psi | U^\dagger(l)\, O(l)\, U(l) | \psi \rangle
$$

由于 $U(l)$ 是 $2^L \times 2^L$ 的大矩阵，对大系统来说计算代价极高。

为此提出一种改进方案：

- 直接在 CUT 的对角基中进行采样；
- 本征态是张量积态，形式简单；
- 可用随机采样近似期望值：
  $$
  \langle O \rangle \approx \frac{1}{\mathcal{N}_s} \sum_{n=1}^{\mathcal{N}_s} \langle E_n | O | E_n \rangle
  $$
- 避免还原，显著降低成本，尤其适合高温系统。

## CUT 方法的数值瓶颈

### 背景

- CUT 将哈密顿量与算符变换到对角形式：
  - $H(l) \to H_{\text{diag}}$，$O(l)$ 为演化算符
- 物理量仍需在原始基底上计算：
  - $O(t) = U^\dagger(l)\, O(l)\, U(l)$

### 数值困难分析

- $U(l)$ 是作用在 Hilbert 空间的幺正变换，维度为 $2^L \times 2^L$；
- 为了计算物理量，需执行以下操作：
  $$
  \langle \psi | U^\dagger(l)\, O(l)\, U(l) | \psi \rangle
  $$
- 即使 $O(l)$ 是对角表示，也需要将其变回原始表示，代价为 $\mathcal{O}(2^{3L})$；
- 大系统下内存和乘法开销巨大。

---

## 在对角基中直接计算观测量

- 在 CUT 过程中，$O(l)$ 与 $H(l)$ 一同变换到对角基；
- $H(l) \to H_{\text{diag}}$，其本征态 $|E_n\rangle$ 是张量积态，结构简单；
- 可在对角基中估算物理量，避免显式使用 $U(l)$：
  $$
  \langle O \rangle = \frac{1}{\mathcal{N}_s} \sum_{n=1}^{\mathcal{N}_s} \langle E_n | O | E_n \rangle
  $$
- 当 $\mathcal{N}_s \ll 2^L$ 时可有效近似 $\operatorname{Tr}(O)$ 或热平均；
- 本征态为占据数表述，例如 $|E_n\rangle = |0\rangle \otimes |1\rangle \otimes \cdots$，作用规则明确。

---

## 什么是算符？

### 概念解释

> 在量子力学中，**算符是一种作用在量子态上的线性映射**，用于表示可观测量或演化过程。

例如：

- 动量算符：$\hat{p} = -i\hbar \nabla$
- 粒子数算符：$n_i = c^\dagger_i c_i$
- 哈密顿量：$H = \sum t_{ij} c^\dagger_i c_j + \cdots$

### 多体系统中的基本算符

| 名称           | 表达式                             | 物理意义                         |
|----------------|-------------------------------------|----------------------------------|
| 产生算符       | $c^\dagger_i$                        | 在格点 $i$ 上创造一个粒子        |
| 湮灭算符       | $c_i$                                | 在格点 $i$ 上湮灭一个粒子        |
| 数目算符       | $n_i = c^\dagger_i c_i$              | 计数格点 $i$ 上是否有粒子        |
| 跳跃项         | $c^\dagger_i c_j$                    | 粒子从 $j$ 跃迁到 $i$            |
| 相互作用项     | $c^\dagger_i c_j c^\dagger_k c_l$    | 粒子间相互作用或交换过程        |

### 在 CUT 中的三类算符

| 角色         | 符号           | 说明                                 |
|--------------|----------------|--------------------------------------|
| 哈密顿量     | $H(l)$         | 系统总能量，目标是对角化它          |
| 生成元       | $\eta(l)$      | 控制系统如何流动（变化）            |
| 观测算符     | $O(l)$         | 被观测的物理量，需同步变换          |

### 算符如何作用在量子态上？

量子态常以 Fock 基底表示，例如：

- $|\psi\rangle = |1,0,1,0\rangle = c^\dagger_1 c^\dagger_3 |0\rangle$

费米子算符满足反对易关系：

- $c^\dagger_i |0\rangle = |i\rangle$
- $c_i |i\rangle = |0\rangle$
- $\{c_i, c_j\} = \{c^\dagger_i, c^\dagger_j\} = 0$, $\{c_i, c^\dagger_j\} = \delta_{ij}$

---

## 总结

- CUT 中所有对象（$H$, $\eta$, $O$）都是**算符表达式**，由基本的 $c^\dagger, c$ 组成；
- 每个算符可以视为一种“对粒子的操作规则”；
- 算符结构可通过表达式管理（表达式级 CUT），也可构造为矩阵（矩阵级 CUT）；
- 不论表达形式如何，它本质是 Hilbert 空间上的线性映射。


# p14

图片展示

# p15

### 哈密顿量 $H(l)$ 的流动（GPU 实现）

核心方程：
$$
\frac{dH(l)}{dl} = [\eta(l), H(l)]
$$

我们将 $H(l)$ 展开为 Pauli 字符串：
$$
H(l) = \sum_\alpha c_\alpha(l)\, P_\alpha
$$

- 每个 $P_\alpha$ 是一个 $L$ 位长的 Pauli 字符串（如 $\sigma^z_1 \sigma^x_3$）；
- $c_\alpha(l)$ 是对应的系数；
- 表达结构天然稀疏，适合 GPU 并行操作；
- 每个线程可处理一个对易子 $[\eta, P_\alpha]$，提升计算效率。

## 哈密顿量 $H(l)$ 的流动（GPU 实现）

### 🔹 1. 为什么使用 Pauli 张量表示？

- 任意量子多体哈密顿量都可以写为 Pauli 字符串的线性组合：
  $$
  H(l) = \sum_\alpha c_\alpha(l) P_\alpha
  $$
- 每个 $P_\alpha$ 是 Pauli 字符串，如 $I \otimes Z \otimes X \otimes I \cdots$
- 这些字符串构成 $2^L$ 维希尔伯特空间上的完备正交基
- 表达稀疏、局域明确，方便用于符号计算和 GPU 并行化

---

### 🔹 2. 在 GPU 上的表示与并行

- 每个 $P_\alpha$ 可以编码为长度为 $L$ 的字符数组（如 `['I', 'Z', 'X', 'I', ...]`）
- 系数 $c_\alpha$ 为浮点型数组，记录张量结构随 $l$ 的变化
- $\eta(l)$ 与 $H(l)$ 的对易操作：
  $$
  \frac{dH(l)}{dl} = [\eta(l), H(l)]
  $$
  可拆解为多个项之间的对易子：
  $$
  [P_\mu, P_\nu] = 2i \, f_{\mu\nu} \cdot P_{\lambda}
  $$
  每一项可独立并行计算，天然适合 GPU 并行线程调度

---

### 🔹 3. 数值实现细节

- 对每一组 Pauli 项 $(P_\mu, P_\nu)$，计算其对易子并映射至新项
- 利用张量 contraction 规则和局域稀疏性加速更新：
  - 缓存对易关系表（类似 lookup-table）
  - 合并同构项，避免指数增长
- 对于高阶项（如 $H^{(4)}$），使用张量编码代替矩阵存储：
  - 索引结构形如 $[i, j, k, q] \to c_\alpha$
  - 并行 contraction 实现 $\mathcal{O}(L^4)$ 级别张量微分

---

### 🔹 4. 结论与优势

- Pauli 表达方式适合 CUT 的代数结构
- GPU 可以加速对易计算与张量更新
- 为 CUT 应用于大系统提供了计算基础

# p17

## 生成元 $\eta(l)$ 的构造（GPU 实现）

CUT 中的生成元 $\eta(l)$ 决定了哈密顿量演化的方向：

$$
\eta(l) = [H_{\text{diag}}(l), H_{\text{off}}(l)]
$$

- **对角项**：Pauli 字符串中仅包含 $Z$ 或 $I$，在计算基中不引起态跳跃；
- **非对角项**：含有 $X$ 或 $Y$，会引起量子态跃迁；

数值实现策略：

- 遍历 $H(l)$ 中所有项，判断是否为对角项；
- 按照 $\eta(l)$ 定义，对每一对项计算对易子；
- 每个组合可独立计算，适合在 GPU 上并行；
- $\eta(l)$ 与 $H(l)$ 使用相同的数据结构存储，便于复用。

# p18

## 缺乏结构压缩导致资源浪费

虽然 CUT 方法在逻辑上使用了稀疏矩阵结构，但在实现中仍使用全量存储：

- 一维系统中，哈密顿量中的非零项**通常少于 10%**；
- 二维系统虽然更稠密，但也存在较大压缩空间；
- 初始化扰动后，非零项仍主要集中在对角线附近；
- 当前实现**未利用这一稀疏性**，导致存储和计算资源浪费。


# p19

## 已尝试的矩阵压缩策略

### 🧩 Tensor Train (TT) 分解

- 将 $H(l)$ 分解为一组低秩张量链，结构为：
  $$
  H(l) \approx \sum_{i_1, \dots, i_L} G^{(1)}_{i_1} G^{(2)}_{i_2} \cdots G^{(L)}_{i_L}
  $$
- 显著压缩高阶张量维度，适合 CUT 中高阶项的表示；
- 支持 GPU 上并行 contraction，性能良好；
- **缺点**：截断误差不可避免，通常控制在 5% 以内；
  - 需调节截断维度（bond dimension）以平衡误差与开销。

---

### 🧩 低秩分解（Low-Rank Decomposition）

- 直接将 $H(l)$ 拆解为若干秩 1 的矩阵乘积；
- 初始压缩率高，速度快；
- 但在 CUT 流动过程中，更新操作会导致秩增长，需频繁重新压缩；
- 秩控制困难时，误差可能迅速积累；
- 适用于**短时间动力学或弱耦系统**。

---

### ⚠️ 总结

- 两种方法本质上都是**近似压缩**；
- **误差来源**：丢弃高秩分量（TT）或秩爆炸后的重压缩（Low-Rank）；
- 在特定条件下可显著提升效率，但需谨慎用于长时间演化。
