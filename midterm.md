---
marp: true
theme: default
paginate: true
---

<!-- _class: lead, align-center -->

# 中期答辩

<p align="center">周予恺  <br>2025年6月3日</p>

---

## 量子动力学研究背景

- **多体量子系统的非平衡动力学研究极具挑战性**
  - 粒子间强相互作用导致计算复杂度指数增长
  - 传统方法难以有效模拟中长期动力学

- **现有数值方法的主要瓶颈**
  - 精确对角化仅限于小规模系统，无法扩展
  - 张量网络方法受限于纠缠障碍（Entanglement Barrier）
  - 量子蒙特卡罗法存在符号问题和稳定性问题

- **亟需新方法突破当前局限性**
  - 发展高效、准确的量子动力学模拟技术
  - 探索可行的中等尺度时间演化问题

---

## 创新方法概述：CUT + 扰乱变换

- **核心思想**：
  - 将经典的 **连续酉变换（CUT / Flow Equations）** 与新提出的 **扰乱变换（Scrambling Transforms）** 相结合。
  - 先用扰乱变换“打乱”哈密顿量的近简并结构，再用 CUT 高效对角化。

- **关键优势**：
  - 显著提高了 CUT 方法的 **收敛性与精度**。
  - 可处理 **大规模哈密顿量** 与 **长时间动力学**，适用于一维与二维无序系统。

- **与张量网络方法的区别**：
  - 张量网络受限于 **纠缠增长**（Entanglement Barrier）。
  - 本方法限制来自于 **近似变换的精度**，在实践中更容易控制。

---

## 系统模型

- **系统类型**：通用的相互作用费米子系统  
  哈密顿量形式：
  $$
  H = \sum_{i,j} H^{(2)}_{ij} : c^\dagger_i c_j : + \sum_{i,j,k,q} H^{(4)}_{ijkq} : c^\dagger_i c_j c^\dagger_k c_q :
  $$
  - $H^{(2)}$：二体跃迁项（动能）
  - $H^{(4)}$：四体相互作用项（费米子作用）

- **符号说明**：
  - $: \cdots :$ 表示正规序（normal ordering）
  - $|\mathcal{L}| = L$：系统晶格点数（即系统规模）


---

## 流方程方法（CUT）

- **核心思想**：通过连续酉变换对角化哈密顿量  
  $$ dU(l) = \exp(-\eta(l)\,dl) = 1 - \eta(l)\,dl $$  
  $$ H(l) = U^\dagger(l)\, H\, U(l), \quad \frac{dH}{dl} = [\eta(l), H(l)] $$

- **流时间 $l$**：一种“算法时间”，从 $l = 0$（初始）演化至 $l \to \infty$（对角化）

- **数值实现**：
  - $H^{(2)}$：以矩阵形式存储，复杂度 $\mathcal{O}(L^2)$
  - $H^{(4)}$：以四阶张量形式存储，复杂度 $\mathcal{O}(L^4)$
  - 截断至四阶，避免高阶爆炸

---

## 多维系统的一维展开
  通过一维化，CUT 可以处理高维的系统

- **展开方法**：
  - 将 $d$ 维晶格编号为 $1, 2, \dots, L$，展开为线性排列
  - 原始的局域耦合转化为一维系统中的“长程跃迁”

- **形式变化**：
  - 原系统：局域哈密顿量，耦合仅限近邻格点
  - 展开后：一维哈密顿量 + 长程跃迁项

- **对 CUT 的影响**：
  - CUT 操作基于对易子与代数结构，**与几何结构无关**
  - 长程项不会影响计算流程
  - 适用于任意维度，适合处理高维无序系统与复杂拓扑结构

---

## 一维化示例

![一维变换示意图](../Anything/Pictures/1D.png)

---

## CUT 方法的潜在问题

- CUT（流方程）方法通过连续酉变换对角化哈密顿量：
  $$ \frac{dH(l)}{dl} = [\eta(l), H(l)] $$

- 通常选择的生成元为：
  $$ \eta(l) = [H_0(l), V(l)] $$
  - $H_0(l)$：哈密顿量的对角部分
  - $V(l)$：哈密顿量的非对角部分

- **不稳定固定点问题**：
  - 如果系统初始状态中存在大量**近简并能级**或缺乏明显的**能量尺度分离**，则流动可能**收敛极慢**甚至**停滞不前**

---

## 问题本质

- 在 Wegner 生成元下，$V(l)$ 的平方范数满足：
  $$ \frac{d}{dl} \|V(l)\|^2 = -2 \|\eta(l)\|^2 \leq 0 $$

- 然而若系统中存在多个 $i \ne j$ 使得：
  $$ |H_{ii}^{(2)}(0) - H_{jj}^{(2)}(0)| \ll 1 $$
  即出现**近简并对角元素**

- 则生成元分量近似为：
  $$ \eta_{ij}(l) \propto (H_{ii}^{(2)} - H_{jj}^{(2)})\, V_{ij}(l) $$

- 导致：
  - $\eta_{ij}(l) \to 0$，即对角化过程难以继续

---

## 扰乱变换的引入

- **解决方案：引入扰乱变换（Scrambling Transform）**
  - 构造形式为酉变换 $S(l)$，不改变物理性质
  - 目的是“打破简并”，提升 CUT 的收敛性

- **扰乱变换的数学形式**：
  $$ dS(l) = \exp\left(-\lambda(l)\, dl\right) $$
  - 其中 $\lambda(l)$ 是专门设计的生成元，用于激活近简并态间的扰动

- **机制说明**：
  - 当能级差 $|H_{ii}^{(2)} - H_{jj}^{(2)}|$ 较小，扰乱变换将主动干预
  - 将哈密顿量转换到更有利于对角化的“预处理基底”

---

## 扰动变换示例

![扰乱变换示意图](../Anything/Pictures/Scrambing.png)

---

## 传统 CUT 方法的数值瓶颈

###  背景：

- CUT 将哈密顿量与算符变换到对角形式：
  - $H(l) \to H_{\text{diag}}$，$O(l)$ 为演化算符
- 物理量仍需在原始基底上计算：
  - $O(t) = U^\dagger(l)\, O(l)\, U(l)$

### 主要困难：

- 酉变换 $U(l)$ 是 $2^L \times 2^L$ 维矩阵
- 实际计算需执行：
  $$
  \langle \psi \lvert U^\dagger(l)\, O(l)\, U(l) \rvert \psi \rangle
  $$
- 在大系统下**内存与计算成本急剧上升**

---

## 在对角基中直接计算观测量

- 在 CUT 过程中，$O(l)$ 与 $H(l)$ 一同被变换到对角基；
- 对角基中的本征态是**张量积态**，形式简单；
- 物理量可直接通过**随机采样本征态**计算：
  $$
  \langle O \rangle = \frac{1}{\mathcal{N}_s} \sum_{n=1}^{\mathcal{N}_s} \langle E_n | O | E_n \rangle
  $$

---

## 改进结果

- 利用对角基下的结构简洁性：本征态 $\lvert E_n \rangle$ 为 product states，直接在对角基中评估

![改进示意图](../Anything/Pictures/Modify.png)

---

## 哈密顿量 $H(l)$ 的流动（GPU 实现）
CUT 的主方程：
$$
\frac{dH(l)}{dl} = [\eta(l), H(l)]
$$
张量结构说明

- $H(l)$ 表示为一组 Pauli 张量项之和：
  $$
  H(l) = \sum_\alpha c_\alpha(l)\, P_\alpha
  $$
- 每个 $P_\alpha$ 为 $L$ 位长的 Pauli 字符串，如 $\sigma^z_1 \sigma^x_3$

---

## 哈密顿量 $H(l)$ 的流动（GPU 实现）
### 稀疏性分析

| 层次 | 特征 | 备注 |
|------|------|------|
| **逻辑表示** | 稀疏 | 仅存储 $c_\alpha \ne 0$ 的项 |
| **GPU 存储** | 非传统稀疏矩阵格式 | 使用数组存储所有活跃张量项 |
| **张量操作** | 稀疏对易子结构 | 仅对非零项成对展开 $[\eta, H]$ |

### gpu 加速实现

- 所有张量项以结构体数组存于 GPU 显存中（位编码）
- 使用 CUDA kernel 对张量对执行并行对易子更新
- Runge–Kutta 推进与结构剪枝均在 GPU 上完成

---

## 生成元 $\eta(l)$ 的构造（GPU 实现）

### 定义：
$$
\eta(l) = [H_{\text{diag}}, H_{\text{off}}]
$$

### 实现

- $H(l)$ 拆分为对角/非对角项（基于 Pauli 字符串结构）
- GPU 并行对每一对张量项执行对易子计算
- 结构复用 $H(l)$ 表示，无需新格式

---

## 缺乏结构压缩导致资源浪费

主流的 CUT 方法虽然在逻辑上采用了稀疏矩阵的方式，但在实际存储的时候，依然是全量存储。
- 实际测试中，在一维系统的不同状态中，哈密顿量中的非零项不会超过矩阵规模的10%；在二维系统中会更加稠密，但依然有大量压缩空间。
- 即使采用了初始化的随机扰动，这些变化也集中在对角线附近的项，不会扩散到整个矩阵。

---

## 已尝试的矩阵压缩策略
### Tensor Train (TT) 分解
- 将 $H(l)$ 表示为若干低秩张量链的乘积结构，极大降低存储复杂度。
- 适合 GPU 上的并行 contraction 操作，压缩效率较好。
- TT 分解本质上是近似压缩，存在截断误差，实际测试中，误差在 5% 以内，需要考虑保留更高阶矩阵。

### 低秩分解（Low-Rank Decomposition）

- 初期压缩效果良好，但在 CUT 的更新流动中往往难以维持固定秩，从而导致秩爆炸或误差传播。
- 在短期演化测试中表现良好，误差和 TT 近似，但计算更快


---

## 数据传输瓶颈

### 出现位置

| 场景 | 描述 | 问题 |
|------|------|------|
| Kernel 调用前后 | 主机端准备结构体传入 GPU | 结构体大，传输慢 |
| 系数剪枝 | GPU 计算后结果回传 CPU 判断 | 中断 GPU 处理流程 |
| 张量项更新 | 新项生成后回传 CPU 合并 | GPU 无结构去重能力 |
| 流动观测输出 | 每步需输出 $H(l)$ 或 $O(l)$ | 频繁拷贝数据慢 |
| 调试与可视化 | 状态输出回传 host | 测试流程耗时长 |

---

## 优化 GPU/CPU 数据传输策略

### 可行优化路径

| 方向 | 策略 | 描述 |
|------|------|------|
| 减少传输频次 | 延迟传输 | 多步数据 batch 输出 |
| 避免来回 | GPU 内剪枝 | 合并 + 删除逻辑直接在 device 中执行 |
| 去除 host 控制 | CUDA Graph | 将调度逻辑写入 CUDA graph |
| 支持动态数据 | memory pooling | 自定义内存池以支持结构变化张量更新 |

---

## 对称性未显式利用

### 系统对称性

- 多体量子系统中常存在**守恒量**与**空间对称性**，Hamiltonian 可**block-diagonal** 化，简化演化空间

### ED和张量方法已经利用了对称性
- ED（精确对角化：预构建特定对称子空间，仅对角对应 block 
- Tensor Network：张量结构中引入对称路径标签，剪枝非法演化路径 

### CUT 方法目前缺失

- $[\eta, H]$ 展开过程中生成大量**不守恒或冗余项**
- 项数膨胀、GPU 执行分歧严重、剪枝难度大

---

<!-- _class: lead, align-center -->

# 感谢各位老师批评指正
